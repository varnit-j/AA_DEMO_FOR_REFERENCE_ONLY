
{% extends 'flight/layout.html' %}
{% load static %}

{% block head %}
<title>SAGA Transaction Failed | Flight Booking</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
<style>
    .saga-header { 
        background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); 
        color: white; 
        padding: 40px; 
        border-radius: 12px; 
        margin-bottom: 30px; 
        text-align: center; 
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); 
    }
    .saga-header h1 { font-size: 2.5rem; font-weight: 700; margin-bottom: 10px; }
    .status-card { 
        background: white; 
        border-radius: 12px; 
        padding: 30px; 
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); 
        border-left: 5px solid #dc3545; 
        margin-bottom: 20px; 
    }
    .status-badge { 
        display: inline-flex; 
        align-items: center; 
        gap: 6px; 
        padding: 6px 12px; 
        border-radius: 20px; 
        font-size: 0.85rem; 
        font-weight: 600; 
    }
    .status-error { background: #fef2f2; color: #ef4444; }
    .btn-custom { 
        display: inline-block; 
        padding: 12px 30px; 
        margin: 0 10px; 
        border-radius: 8px; 
        text-decoration: none; 
        font-weight: 600; 
        transition: all 0.3s ease; 
    }
    .log-container {
        background: #1e1e1e;
        color: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        font-family: 'Courier New', monospace;
        font-size: 13px;
        max-height: 400px;
        overflow-y: auto;
        margin: 20px 0;
        border: 1px solid #495057;
    }
    .log-entry {
        margin-bottom: 8px;
        padding: 4px 0;
        border-bottom: 1px solid #343a40;
    }
    .log-timestamp {
        color: #6c757d;
        margin-right: 10px;
    }
    .log-level-info { color: #17a2b8; }
    .log-level-error { color: #dc3545; font-weight: bold; }
    .log-level-success { color: #28a745; }
    .log-level-warning { color: #ffc107; }
    .log-level-compensation { color: #fd7e14; }
</style>
{% endblock %}

{% block body %}
<!-- Hidden data for JavaScript -->
<script id="saga-logs-data" type="application/json">{{ saga_logs|safe }}</script>

<div class="saga-header">
    <div class="container">
        <h1><i class="fas fa-exclamation-triangle"></i> SAGA Transaction Failed</h1>
        <p>Distributed Transaction Failed with Automatic Compensation</p>
        {% if correlation_id %}
            <div style="background: rgba(255, 255, 255, 0.2); padding: 15px; border-radius: 8px; margin-top: